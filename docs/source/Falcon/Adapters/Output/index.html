<!DOCTYPE html>
<html>
	<head>
		
			<title>::Falcon::Adapters::Output</title>
		
		<meta charset="UTF-8"/>
		
		<link rel="icon" type="image/png" href="../../../../_static/icon.png"/>
		<link rel="stylesheet" href="../../../../_static/site.css" type="text/css" media="screen"/>
		
		<script src="../../../../_components/jquery/jquery.min.js"></script>
		<script src="../../../../_components/jquery-syntax/jquery.syntax.min.js"></script>
		
		<script type="text/javascript">
		//<![CDATA[
			jQuery(function($) {
				$.syntax();
			});
		//]]>
		</script>
	</head>

	<body class="">
		
	<nav> › <a class="link" href="../../../../index.html">Project</a> › <a class="link" href="../../../index.html">Source</a></nav>

<h1><code class="language-ruby">::Falcon::Adapters::Output</code></h1>
	
	<main>
		<p>Wraps the rack response body.
The Body must respond to each and must only yield String values. The Body itself should not be an instance of String, as this will break in Ruby 1.9. If the Body responds to close, it will be called after iteration. If the body is replaced by a middleware after action, the original body must be closed first, if it responds to close. If the Body responds to to_path, it must return a String identifying the location of a file whose contents are identical to that produced by calling each; this may be used by the server as an alternative, possibly more efficient way to transport the response. The Body commonly is an Array of Strings, the application instance itself, or a File-like object.</p>
		
		
		<h2>Definitions</h2>
		
		<h3 id="::Falcon::Adapters::Output.wrap"><code class="language-ruby">def self.wrap(status, headers, body)</code></h3><p>Wraps an array into a buffered body.</p>
<section class="collapsible">
							<input type="checkbox" id="::Falcon::Adapters::Output.wrap-implementation"/>
							<label for="::Falcon::Adapters::Output.wrap-implementation">
								<h4>Implementation</h4>
							</label>
							<pre><code class="language-ruby">def self.wrap(status, headers, body)
	# In no circumstance do we want this header propagating out:
	if length = headers.delete(CONTENT_LENGTH)
		# We don't really trust the user to provide the right length to the transport.
		length = Integer(length)
	end
	
	if body.is_a?(::Protocol::HTTP::Body::Readable)
		return body
	elsif status == 200 and body.respond_to?(:to_path)
		# Don't mangle partial responsese (206)
		return ::Protocol::HTTP::Body::File.open(body.to_path)
	elsif body.is_a?(Array)
		length ||= body.sum(&amp;:bytesize)
		return self.new(body, length)
	else
		return self.new(body, length)
	end
end</code></pre>
						</section><h3 id="::Falcon::Adapters::Output:body"><code class="language-ruby">attr :body</code></h3><p>The rack response body.</p>
<h3 id="::Falcon::Adapters::Output:length"><code class="language-ruby">attr :length</code></h3><p>The content length of the rack response body.</p>
	</main>

		
		<footer>Documentation generated by <a href="https://github.com/socketry/utopia-project">Utopia::Project</a>.</footer>
	</body>
</html>